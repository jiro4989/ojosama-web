<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ojosama web converter</title>
    <script>
      async function convert() {
        document.getElementById("progress").innerHTML = "処理中";
        const text = document.getElementById("input").value;
        const data = {"Text": text}
        const url = location.protocol + "//" + location.host + "/api/ojosama";
        const resp = await fetch(url, {
          method: "POST",
          mode: 'cors',
          headers: {
            "Content-type": "application/json"
          },
          body: JSON.stringify(data)
        });
        const result = await resp.json();
        document.getElementById("output").value = result.Result;
        progress.innerHTML = "変換完了！";

        activeTweetButton(result.Result !== "");
      }

      function tweet() {
        const url = location.protocol + "//" + location.host;
        const output = document.getElementById("output").value;
        const message = `${output}\n\nOjosama web converter\n`;
        const encodedMessage = encodeURIComponent(message);
        const encodedURL = encodeURIComponent(url);
        const tweetURL = "https://twitter.com/intent/tweet" + `?url=${encodedURL}&text=${encodedMessage}`;
        window.open(tweetURL, "");
      }

      function activeTweetButton(active) {
        const tweetButton = document.getElementById("tweet-button");
        if (active === true) {
          tweetButton.removeAttribute("disabled");
        } else {
          tweetButton.setAttribute("disabled");
        }
      }
    </script>
    <style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #523244;
}

.app {
  font-size: 18px;
  font-family: sans-serif;
}

header, footer {
  background-color: #CD3896;
  color: #fff;
  text-align: center;
}

footer {
  background-color: #523244;
}

section {
  padding: 1%;
  margin: 1%;
  color: #fff;
  border-radius: 2px;
  background-color: #CD3896;
}

textarea {
  width: 100%;
  font: 15px/24px sans-serif;
  box-sizing: border-box;
  transition: 0.3s;
  letter-spacing: 1px;
  color: #111111;
  height: 18vh;
}

h1 {
  margin: 0;
  padding: 1%;
}

h1, h2 {
  margin: 0;
  padding: 1%;
  font-family: fantasy, sans-serif;
}

a {
  color: #ddd;
}

.main-area {
  margin-left: auto;
  margin-right: auto;
  width: 60vw;
}

.button {
  width: 30%;
  height: 5vh;
}

    </style>
</head>

<body>
  <div class="app">
    <header>
      <h1>Ojosama web converter</h1>
      <p>テキストを壱百満天原サロメお嬢様風の口調に変換します</p>
    </header>
    <div class="main-area">
      <section>
        <h2>入力</h2>
        <p>テキストを入力して「変換」ボタンを押すと、「出力」に結果が表示されます。</p>
        <div>
          <textarea id="input" name="" placeholder="例: ハーブです！セーブはどこですか？"></textarea>
        </div>
        <input class="button" type="button" value="変換" onclick="convert();">
      </section>
      <section>
        <h2>出力</h2>
        <p id="progress">ここに結果が表示されます。</p>
        <div>
          <textarea id="output" name="" placeholder="例: おハーブですわ～❗❗セーブはどちらですの？"></textarea>
        </div>
        <input id="tweet-button" class="button" disabled type="button" value="ツイート" onclick="tweet();">
      </section>
    </div>
    <footer>
      Copyright (C) 2022 <a href="https://github.com/jiro4989">jiro4989</a> |
      Source code :
      <a href="https://github.com/jiro4989/ojosama-web">
        Web
      </a>
      /
      <a href="https://github.com/jiro4989/ojosama">
        Library
      </a>
    </footer>
  </div>
</body>

</html>
